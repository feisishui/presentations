/**
 * Copyright @ 2016 Esri.
 * All rights reserved under the copyright laws of the United States and applicable international laws, treaties, and conventions.
 */
define(["dojo/_base/declare","../support/fx3dUtils"],function(t,e){var i=0,_=t(null,{declaredClass:"esri.views.3d.webgl-engine-extensions.GLVerTexture",constructor:function(t){this.id=i++,this._gl=t,this._ready=!1,this._pixelDataType=null,this._gl&&(this._textureHandle=this._gl.createTexture())},_initParams:function(){this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)},_reset:function(t,i){this._width=t,this._height=i,this._pixelSize=window.parseInt(this._width*this._height*4),this._isPowerOfTwo=e.isPowerOfTwo(t)&&e.isPowerOfTwo(i),this._isPowerOfTwo||console.warn("Width and height are not power of 2. So the rendering may be incorrect.")},setData:function(t,e,i){if(this._textureHandle){if(i instanceof Uint8Array)this._pixelDataType=this._gl.UNSIGNED_BYTE;else{if(!(i instanceof Float32Array))return;this._pixelDataType=this._gl.FLOAT}this._reset(t,e),isNaN(this._pixelSize)||this._pixelSize!==i.length||(this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,i),this._initParams(),this._gl.bindTexture(this._gl.TEXTURE_2D,null))}},bind:function(t){this._textureHandle&&("number"==typeof t&&this._gl.activeTexture(this._gl.TEXTURE0+t),this._gl.bindTexture(this._gl.TEXTURE_2D,this._textureHandle))},unbind:function(){this._gl.bindTexture(this._gl.TEXTURE_2D,null)},release:function(){this._gl.bindTexture(this._gl.TEXTURE_2D,null)},getTextureHandle:function(){return this._textureHandle},dispose:function(){this._textureHandle.__deleted__=!0,this._gl.deleteTexture(this._textureHandle)}});return _});